<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>P-Alert MVP - 体調記録</title>
</head>
<body style="font-family: sans-serif; max-width: 720px; margin: 24px auto; padding: 0 16px;">

  <div style="display:flex; justify-content: space-between; align-items:center;">
    <h1>P-Alert MVP</h1>
    <div>
      <a href="/">気圧へ</a> |
      <a href="/logout">ログアウト</a>
    </div>
  </div>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div style="background:#f5f5f5; padding:12px; border-radius:8px; margin: 12px 0;">
        {% for msg in messages %}
          <div>• {{ msg }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <h2 style="margin-top:16px;">体調記録（ずつうログ）</h2>

  <form method="post" action="/health" style="background:#f7fbff; padding:12px; border-radius:10px;">
    <div style="margin: 8px 0;">
      <label>体調スコア（1〜10）：</label><br>
      <input name="score" type="number" min="1" max="10" required style="width:100%; padding:10px;">
    </div>
    <div style="margin: 8px 0;">
      <label>メモ（任意）：</label><br>
      <textarea name="note" rows="3" style="width:100%; padding:10px;"></textarea>
    </div>
    <button type="submit" style="padding:10px 16px;">記録する</button>
  </form>

  <h2 style="margin-top: 18px;">履歴（最新50件）</h2>

  {% if logs %}
    <ul>
      {% for row in logs %}
        <li style="margin: 10px 0;">
          <div><strong>{{ row["log_at"] }}</strong></div>
          <div>スコア：{{ row["score"] }}</div>
          <div>メモ：{{ row["note"] or "" }}</div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>まだ記録がありません。</p>
  {% endif %}

</body>
</html>
